Screen1 As screen:

    con As groupContainer.verticalAutoLayoutContainer:
        Height: =476
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        Width: =1366
        ZIndex: =2

        Container1 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(39, 67, 125, 1)
            FillPortions: =0
            Height: =100
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =32
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =2500
            ZIndex: =1

            Label1 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Date
                    "
                Width: =100
                ZIndex: =1

            Label1_1 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Bank Name
                    "
                Width: =180
                ZIndex: =2

            Label1_2 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Merchant Name
                    "
                Width: =220
                ZIndex: =3

            Label1_3 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Address
                    "
                Width: =120
                ZIndex: =4

            Label1_4 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="District
                    "
                Width: =110
                ZIndex: =5

            Label1_5 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="TID
                    "
                Width: =80
                ZIndex: =6

            Label1_6 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="MID
                    "
                ZIndex: =7

            Label1_7 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Serial No.
                    "
                Width: =180
                ZIndex: =8

            Label1_8 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Terminal Type
                    "
                Width: =200
                ZIndex: =9

            Label1_9 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Ownership
                    "
                Width: =160
                ZIndex: =10

            Label1_10 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Status
                    "
                Width: =120
                ZIndex: =11

            Label1_11 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Days Run
                    "
                Width: =160
                ZIndex: =12

            Label1_12 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Rental Fee
                    "
                Width: =160
                ZIndex: =13

            Label1_13 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="FinalAmt"
                Width: =140
                ZIndex: =14

        "galBankWisePOSDetail As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            AlignInContainer: =AlignInContainer.SetByContainer
            DelayItemLoading: =true
            FillPortions: =0
            Height: =300
            Items: =Filter(tbl_mst_AllBankData, BankName = drpBankName.SelectedText.Value)
            Layout: =Layout.Vertical
            LayoutMinHeight: =287
            LayoutMinWidth: =320
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =104
            Width: =2500
            ZIndex: =2

            Label3 As label:
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.BankName
                Width: =151
                X: =145
                Y: =24
                ZIndex: =1

            Label3_1 As label:
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Date
                Width: =117
                X: =3
                Y: =24
                ZIndex: =2

            Label3_2 As label:
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.MerchantName
                Width: =237
                X: =351
                Y: =24
                ZIndex: =3

            Label3_3 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Address
                Width: =147
                X: =577
                Y: =24
                ZIndex: =4

            Label3_4 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.District
                Width: =147
                X: =724
                Y: =24
                ZIndex: =5

            Label3_5 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.TID
                Width: =147
                X: =860
                Y: =24
                ZIndex: =6

            Label3_6 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.MID
                Width: =147
                X: =1007
                Y: =24
                ZIndex: =7

            Label3_7 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.SerialNo
                Width: =147
                X: =1213
                Y: =24
                ZIndex: =8

            Label3_8 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.TerminalType
                Width: =147
                X: =1420
                Y: =24
                ZIndex: =9

            Label3_9 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Ownership
                Width: =147
                X: =1643
                Y: =24
                ZIndex: =10

            Label3_10 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.'Status (cr69c_status)'
                Width: =147
                X: =1806
                Y: =24
                ZIndex: =11

            Label3_11 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.DaysRun
                Width: =147
                X: =1967
                Y: =24
                ZIndex: =12

            Label3_12 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.RentalFee
                Width: =147
                X: =2166
                Y: =24
                ZIndex: =13

            Label3_13 As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.FinalAmt
                Width: =147
                X: =2345
                Y: =24
                ZIndex: =14

    drpBankName As dropdown:
        Items: =tbl_mst_Banks
        Y: =512
        ZIndex: =3

    Button1 As button:
        OnSelect: |+
            =
            Set(
                BankData,
                BankWisePOSReportsFlow.Run(dteDateFrom_1.SelectedDate,dteDateTo_1.SelectedDate)
            );
            Set(
                parsedData,
                ParseJSON(BankData.output)
            );
            Set(
                parsedRetrieveData,
                ParseJSON(BankData.outputretrieveterminal)
            );
            ClearCollect(
                colBankData,
                ForAll(
                    Table(parsedData),
                    {
                        deployDate: Text(Value.deployDate),
                        bankName: Text(Value.bankName),
                        MerchantName:Text(Value.merchantName),
                        Address:Text(Value.merchantAddress),
                        District:(Value.merchantAddress),
                        TID: Text(Value.idTerminal),
                        MID:Text(Value.idMerchant),
                        SerialNumber:Text(Value.serialKey),
                        TerminalType:Text(Value.merchantName),
                        Ownership:Text(Value.ownership),
                        Status: Text(Value.deploymentStatus)
                    }
                )
            );
            ClearCollect(
                colRetBankData,
                ForAll(
                    Table(parsedRetrieveData),
                    {
                        deployDate: Text(Value.deployDate),
                        bankName: Text(Value.bankName),
                        MerchantName:Text(Value.merchantName),
                        Address:Text(Value.merchantAddress),
                        District:(Value.merchantAddress),
                        TID: Text(Value.idTerminal),
                        MID:Text(Value.idMerchant),
                        SerialNumber:Text(Value.serialKey),
                        TerminalType:Text(Value.merchantName),
                        Ownership:Text(Value.ownership),
                        Status: Text(Value.deploymentStatus)
                    }
                )
            );
            ForAll(colBankData,
            Patch(tbl_mst_AllBankData,Defaults(tbl_mst_AllBankData),{
                Date:DateValue(ThisRecord.deployDate),
                BankName:Text(ThisRecord.bankName),
                MerchantName:Text(ThisRecord.MerchantName),  
                Address:Text(ThisRecord.Address),
                District:Text(ThisRecord.District),
                TID:Text(ThisRecord.TID),
                MID:Text(ThisRecord.MID),
                SerialNo:Text(ThisRecord.SerialNumber),
                TerminalType:Text(ThisRecord.TerminalType),
                Ownership:Text(ThisRecord.Ownership),
                'Status (cr69c_status)':"Live",
                DaysRun:Text(If(ThisRecord.Status="Retrieval",DateDiff(dteDateFrom_1.SelectedDate,ThisRecord.deployDate,TimeUnit.Days)+1, 30 )),
                RentalFee:Text(900),
                FinalAmt:Text(If(ThisRecord.Status="Retrieval",DateDiff(dteDateFrom_1.SelectedDate,ThisRecord.deployDate,TimeUnit.Days)+1, 30 )*900)
                
            }));
            ForAll(colRetBankData,
            Patch(tbl_mst_AllBankData,Defaults(tbl_mst_AllBankData),{
                Date:DateValue(ThisRecord.deployDate),
                BankName:Text(ThisRecord.bankName),
                MerchantName:Text(ThisRecord.MerchantName),  
                Address:Text(ThisRecord.Address),
                District:Text(ThisRecord.District),
                TID:Text(ThisRecord.TID),
                MID:Text(ThisRecord.MID),
                SerialNo:Text(ThisRecord.SerialNumber),
                TerminalType:Text(ThisRecord.TerminalType),
                Ownership:Text(ThisRecord.Ownership),
                'Status (cr69c_status)':Text(ThisRecord.Status),
                DaysRun:Text(If(ThisRecord.Status="Retrieval",DateDiff(dteDateFrom_1.SelectedDate,ThisRecord.deployDate,TimeUnit.Days)+1, 30 )),
                RentalFee:Text(900),
                FinalAmt:Text(If(ThisRecord.Status="Retrieval",DateDiff(dteDateFrom_1.SelectedDate,ThisRecord.deployDate,TimeUnit.Days)+1, 30 )*900)
                
            }));
            
            Notify("Deployed Terminal List Synced Successfully",NotificationType.Success);
            
        Text: ="Sync Deploy"
        X: =168
        Y: =640
        ZIndex: =4

    dteDateFrom_1 As datepicker:
        DefaultDate: =First(tbl_Dates).DateFrom
        Height: =38
        Width: =200
        X: =905
        Y: =514
        ZIndex: =5

    dteDateTo_1 As datepicker:
        DefaultDate: =DateValue(First(tbl_Dates).DateTo)
        Height: =38
        Width: =200
        X: =1149
        Y: =514
        ZIndex: =6

    lblDateFrom_1 As label:
        Height: =38
        Text: ="Date from"
        Width: =126
        X: =905
        Y: =476
        ZIndex: =7

    lblDateTo_1 As label:
        Height: =38
        Text: |-
            ="Date to
            "
        Width: =91
        X: =1149
        Y: =476
        ZIndex: =8

    SyncRetrieve As button:
        OnSelect: |-
            =
            Set(
                BankData,
                BankWisePOSReportsFlow.Run(
                    dteDateFrom.SelectedDate,
                    dteDateTo.SelectedDate
                )
            );
            Set(
                parsedRetrieveData,
                ParseJSON(BankData.outputretrieveterminal)
            );
            ClearCollect(
                colRetrieveData,
                ForAll(
                    Table(parsedRetrieveData),
                    {
                        bankName: Text(Value.bankName),
                        deployDate: Text(Value.updatedDate),
                        MerchantName:Text(Value.merchant),
                        Address:Text(Value.address),
                        dis:(Value.district),
                        TID: Text(Value.idTerminal),
                        MID:Text(Value.idMerchant),
                        SerialNumber:Text(Value.serialNumber),
                        TerminalType:Text(Value.terminalType),
                        Ownership:Text(Value.ownership),
                        Status: Text(Value.teminalStatus),
                        FinalAmt:950
            
                    }
                )
            );
            RemoveIf(
                tbl_Dates,
                true
            );
            Patch(
                tbl_Dates,
                Defaults(tbl_Dates),
                {
                    DateFrom: dteDateFrom.SelectedDate,
                    DateTo: dteDateTo.SelectedDate
                }
            );
            UpdateContext({locDateFrom: DateValue(First(tbl_Dates).DateFrom)});
            ClearCollect(
                colRetrievePrice,
                ForAll(
                    colRetrieveData,
                    {
                        bankName: ThisRecord.bankName,
                        retrieveDate: ThisRecord.updatedDate,
                        Price: ((DateDiff(locDateFrom, DateValue(ThisRecord.updatedDate), TimeUnit.Days)+1)*900/30)
            
                    }
                )
            );
            
            Notify("Retrieved Terminal List Retrieved Successfully",NotificationType.Success);
        Text: ="Button"
        X: =389
        Y: =640
        ZIndex: =9

    btnExportToExcel As button:
        OnSelect: |-
            =Collect(colExportToExcel,ShowColumns(galBankWisePOSDetail.AllItems,"cr69c_date","cr69c_bankname","cr69c_merchantname", "cr69c_address","cr69c_district","cr69c_tid","cr69c_mid","cr69c_serialno", "cr69c_terminaltype","cr69c_ownership","cr69c_daysrun","cr69c_rentalfee","cr69c_finalamt"));
            ExportToExcel.Run(JSON(colExportToExcel),drpBankName.SelectedText.Value);
        Text: ="Export to Excel"
        X: =821
        Y: =677
        ZIndex: =10

