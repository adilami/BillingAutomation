FetchBankWisePOSReport As screen:

    containerGalleryBankWisePOSDetail As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Bold
        Height: =500
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        RadiusBottomLeft: =12
        RadiusBottomRight: =12
        RadiusTopLeft: =12
        RadiusTopRight: =12
        Width: =1365
        ZIndex: =2

        conrainerHeader As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(39, 67, 125, 1)
            FillPortions: =0
            Height: =100
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =32
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =2900
            ZIndex: =1

            lblDate As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Date
                    "
                Width: =100
                ZIndex: =1

            lblBanksName As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Bank Name
                    "
                Width: =180
                ZIndex: =2

            lblMerchantName As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Merchant Name
                    "
                Width: =220
                ZIndex: =3

            lblAddress As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Address
                    "
                Width: =120
                ZIndex: =4

            lblDistrict As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="District
                    "
                Width: =110
                ZIndex: =5

            lblTID As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="TID
                    "
                Width: =80
                ZIndex: =6

            lblMID As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="MID"
                ZIndex: =7

            lblSerialNo As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Serial No.
                    "
                Width: =180
                ZIndex: =8

            lblTerminalTypes As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Terminal Type
                    "
                Width: =200
                ZIndex: =9

            lblOwnership As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Ownership
                    "
                Width: =160
                ZIndex: =10

            lblStatus As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Status
                    "
                Width: =120
                ZIndex: =11

            lblRentalFee As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Rental Fee
                    "
                Width: =160
                ZIndex: =12

            lblDaysRun As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Days Run
                    "
                Width: =160
                ZIndex: =13

            lblCashAdvance As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="Cash Adv"
                Width: =140
                ZIndex: =14

            lblPinChange As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="Pin Change"
                Width: =160
                ZIndex: =15

            lblFinalAmt_2 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="FinalAmt"
                Width: =140
                ZIndex: =16

        "galBankWisePOSDetail As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            AlignInContainer: =AlignInContainer.SetByContainer
            DelayItemLoading: =true
            FillPortions: =0
            Height: =400
            Items: =If(drpBankName.SelectedText.Value="All Bank", Filter(colAllData, ThisRecord.Date<dteToDate.SelectedDate), Filter(colAllData, BankName = drpBankName.SelectedText.Value And ThisRecord.Date<dteToDate.SelectedDate))
            Layout: =Layout.Vertical
            LayoutMinHeight: =287
            LayoutMinWidth: =320
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =104
            Width: =2900
            ZIndex: =2

            lblBankNameContent As label:
                Align: =Align.Center
                Height: =47
                OnSelect: =Select(Parent)
                Text: =ThisItem.BankName
                Width: =206
                X: =118
                Y: =24
                ZIndex: =1

            lblDateContent As label:
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Date
                Width: =117
                X: =12
                Y: =24
                ZIndex: =2

            lblMerchantNameContent As label:
                Align: =Align.Center
                Height: =68
                OnSelect: =Select(Parent)
                Text: =ThisItem.MerchantName
                Width: =261
                X: =316
                Y: =17
                ZIndex: =3

            lblDistrictContent As label:
                Align: =Align.Center
                Height: =64
                OnSelect: =Select(Parent)
                Text: =ThisItem.District
                Width: =154
                X: =746
                Y: =21
                ZIndex: =5

            lblTIDContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.TID
                Width: =147
                X: =884
                Y: =30
                ZIndex: =6

            lblMIDContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.MID
                Width: =184
                X: =1024
                Y: =30
                ZIndex: =7

            lblSerialNoContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.SerialNo
                Width: =195
                X: =1214
                Y: =30
                ZIndex: =8

            lblTerminalTypeContent As label:
                Align: =Align.Center
                Height: =82
                OnSelect: =Select(Parent)
                Text: =ThisItem.TerminalType
                Width: =239
                X: =1403
                Y: =12
                ZIndex: =9

            lblOwnershipContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Ownership
                Width: =167
                X: =1630
                Y: =24
                ZIndex: =10

            lblStatusContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Status
                Width: =156
                X: =1819
                Y: =24
                ZIndex: =11

            lblDaysRunContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.DaysRun
                Width: =147
                X: =2175
                Y: =24
                ZIndex: =12

            lblRentalFeeContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.RentalFee
                Width: =147
                X: =2000
                Y: =24
                ZIndex: =13

            lblFinalAmtContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.FinalAmt
                Width: =147
                X: =2737
                Y: =24
                ZIndex: =14

            lblAddressContent As label:
                Align: =Align.Center
                Height: =71
                OnSelect: =Select(Parent)
                Text: =ThisItem.Address
                Width: =186
                X: =577
                Y: =17
                ZIndex: =15

            lblCashAdvanceContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.CashAdvance
                Width: =147
                X: =2364
                Y: =24
                ZIndex: =16

            lblPinChangeContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.PinChange
                Width: =147
                X: =2544
                Y: =25
                ZIndex: =17

    drpBankName As dropdown:
        Items: =tbl_mst_Banks
        OnChange: |-
            =If(drpBankName.SelectedText.Value="MACHHAPUCHCHHRE BANK LTD." Or drpBankName.SelectedText.Value="All Bank",UpdateContext({locTogText:true}),UpdateContext({locTogText:false}));
            Clear(colAllData);
        OnSelect: =
        X: =49
        Y: =582
        ZIndex: =3

    btnFetchData As button:
        OnSelect: |
            =Set(
                glbToggleButton,
                false
            );
            RemoveIf(
                tbl_Dates,
                true
            );
            Patch(
                tbl_Dates,
                Defaults(tbl_Dates),
                {
                    DateFrom: dteFromDate.SelectedDate,
                    DateTo: dteToDate.SelectedDate
                }
            );
            UpdateContext({locDateFrom: DateValue(First(tbl_Dates).DateFrom)});
            Set(
                BankData,
                BankWisePOSReportsFlow.Run(
                    dteFromDate.SelectedDate,
                    dteToDate.SelectedDate
                )
            );
            Set(
                parsedData,
                ParseJSON(BankData.output)
            );
            Set(
                parsedRetrieveData,
                ParseJSON(BankData.outputretrieveterminal)
            );
            If(
                drpBankName.SelectedText.Value = "All Bank",
                ClearCollect(
                    colBankData,
                    ForAll(
                        Table(parsedData),
                        {
                            deployDate: Text(Value.deployDate),
                            bankName: Text(Value.bankName),
                            MerchantName: Text(Value.merchantName),
                            Address: Text(Value.merchantAddress),
                            District: (Value.district),
                            TID: Text(Value.idTerminal),
                            MID: Text(Value.idMerchant),
                            SerialNumber: Text(Value.serialKey),
                            TerminalType: Text(Value.terminalType),
                            Ownership: Text(Value.ownership),
                            Status: Text(Value.deploymentStatus),
                            CashAdvance: If(
                                Value.cashAdvance = false,
                                "false",
                                "true"
                            ),
                            PinChange: If(
                                Value.pinChange = false,
                                "false",
                                "true"
                            )
                        }
                    )
                );
                ClearCollect(
                    colRetBankData,
                    ForAll(
                        Table(parsedRetrieveData),
                        {
                            deployDate: Text(Value.updatedDate),
                            bankName: Text(Value.bankName),
                            MerchantName: Text(Value.merchant),
                            Address: Text(Value.address),
                            District: (Value.district),
                            TID: Text(Value.idTerminal),
                            MID: Text(Value.idMerchant),
                            SerialNumber: Text(Value.serialNumber),
                            TerminalType: Text(Value.terminalType),
                            Ownership: Text(Value.ownership),
                            Status: Text(Value.teminalStatus),
                            CashAdvance: If(
                                Value.cashAdvance = false,
                                "false",
                                "true"
                            ),
                            PinChange: If(
                                Value.pinChange = false,
                                "false",
                                "true"
                            )
                        }
                    )
                );
                ClearCollect(
                    colALLRET,
                    ForAll(
                        colRetBankData,
                        {
                            Date: DateValue(ThisRecord.deployDate),
                            BankName: Text(ThisRecord.bankName),
                            MerchantName: Text(ThisRecord.MerchantName),
                            Address: Text(ThisRecord.Address),
                            District: Text(ThisRecord.District),
                            TID: Text("'" & ThisRecord.TID & "'"),
                            MID: Text("'" & ThisRecord.MID & "'"),
                            SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                            TerminalType: Text(ThisRecord.TerminalType),
                            Ownership: Text(ThisRecord.Ownership),
                            Status: Text(ThisRecord.Status),
                            CashAdvance: Text(ThisRecord.CashAdvance),
                            PinChange: Text(ThisRecord.PinChange),
                            DaysRun: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        Value(txtNumberOfDays.Text)
                                    );
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            30
                                        );
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text(
                                            If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            );
                                        ),
                                        Text(
                                            If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            );
                                        )
                                    )
                                )
                            ),
                            RentalFee: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    LookUp(
                                        tbl_mst_Rates,
                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership
                                    ).Rate
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text("0"),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = bankName && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership
                                            ).Rate
                                        )
                                    )
                                )
                            ),
                            FinalAmt: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    (If(
                                        ThisRecord.Status = "Retrieval",
                                        If(
                                            ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                            0,
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            Value(txtNumberOfDays.Text)
                                        ) / Value(txtNumberOfDays.Text)
                                    ) * LookUp(
                                        tbl_mst_Rates,
                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                    ).Rate);
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                        ).Rate
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            If(
                                                ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                                0,
                                                (If(
                                                    ThisRecord.Status = "Retrieval",
                                                    DateDiff(
                                                        dteFromDate.SelectedDate,
                                                        ThisRecord.deployDate,
                                                        TimeUnit.Days
                                                    ) + 1,
                                                    30
                                                ) / 30) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                ).Rate
                                            );
                                        )
                                    )
                                )
                            )
                        }
                    )
                );
                ClearCollect(
                    colALLDEP,
                    ForAll(
                        colBankData,
                        {
                            Date: DateValue(ThisRecord.deployDate),
                            BankName: Text(ThisRecord.bankName),
                            MerchantName: Text(ThisRecord.MerchantName),
                            Address: Text(ThisRecord.Address),
                            District: Text(ThisRecord.District),
                            TID: Text("'" & ThisRecord.TID & "'"),
                            MID: Text("'" & ThisRecord.MID & "'"),
                            SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                            TerminalType: Text(ThisRecord.TerminalType),
                            Ownership: Text(ThisRecord.Ownership),
                            Status: Text(ThisRecord.Status),
                            CashAdvance: Text(ThisRecord.CashAdvance),
                            PinChange: Text(ThisRecord.PinChange),
                            DaysRun: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            Value(txtNumberOfDays.Text),
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > Value(txtNumberOfDays.Text),
                                                Value(txtNumberOfDays.Text),
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1)
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                            Value(txtNumberOfDays.Text)
                                        )
                                    );
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        If(
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                30,
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > 30,
                                                    30,
                                                    DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                30
                                            )
                                        );
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30,
                                                        DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30
                                                )
                                            );
                                        ),
                                        Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30,
                                                        DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30
                                                )
                                            );
                                        )
                                    )
                                )
                            ),
                            RentalFee: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    LookUp(
                                        tbl_mst_Rates,
                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                    ).Rate
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                        ).Rate
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate
                                        )
                                    )
                                )
                            ),
                            FinalAmt: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate,
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > Value(txtNumberOfDays.Text),
                                                Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                ).Rate,
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) / Value(txtNumberOfDays.Text) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                ).Rate
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                            Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate
                                        )
                                    )
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                        ).Rate
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30 / 30 * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                    ).Rate,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30 / 30 * LookUp(
                                                            tbl_mst_Rates,
                                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                        ).Rate,
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) / 30 * LookUp(
                                                            tbl_mst_Rates,
                                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                        ).Rate
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30 / 30 * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                    ).Rate
                                                )
                                            );
                                        )
                                    )
                                )
                            )
                        }
                    )
                );
                ClearCollect(
                    colAllData,
                    colALLDEP
                );
                Collect(
                    colAllData,
                    colALLRET
                );
                Set(
                    glbToggleButton,
                    true
                );
                Notify(
                    "Both Deployed and Retrieved Terminal Synced Successfully",
                    NotificationType.Success
                );
                ,
                ClearCollect(
                    colBankData,
                    ForAll(
                        Table(parsedData),
                        {
                            deployDate: Text(Value.deployDate),
                            bankName: Text(Value.bankName),
                            MerchantName: Text(Value.merchantName),
                            Address: Text(Value.merchantAddress),
                            District: (Value.district),
                            TID: Text(Value.idTerminal),
                            MID: Text(Value.idMerchant),
                            SerialNumber: Text(Value.serialKey),
                            TerminalType: Text(Value.terminalType),
                            Ownership: Text(Value.ownership),
                            Status: Text(Value.deploymentStatus),
                            CashAdvance: If(
                                Value.cashAdvance = false,
                                "false",
                                "true"
                            ),
                            PinChange: If(
                                Value.pinChange = false,
                                "false",
                                "true"
                            )
                        }
                    )
                );
                ClearCollect(
                    colRetBankData,
                    ForAll(
                        Table(parsedRetrieveData),
                        {
                            deployDate: Text(Value.updatedDate),
                            bankName: Text(Value.bankName),
                            MerchantName: Text(Value.merchant),
                            Address: Text(Value.address),
                            District: (Value.district),
                            TID: Text(Value.idTerminal),
                            MID: Text(Value.idMerchant),
                            SerialNumber: Text(Value.serialNumber),
                            TerminalType: Text(Value.terminalType),
                            Ownership: Text(Value.ownership),
                            Status: Text(Value.teminalStatus),
                            CashAdvance: If(
                                Value.cashAdvance = false,
                                "false",
                                "true"
                            ),
                            PinChange: If(
                                Value.pinChange = false,
                                "false",
                                "true"
                            )
                        }
                    )
                );
                ClearCollect(
                    colALLRET,
                    ForAll(
                        colRetBankData,
                        {
                            Date: DateValue(ThisRecord.deployDate),
                            BankName: Text(ThisRecord.bankName),
                            MerchantName: Text(ThisRecord.MerchantName),
                            Address: Text(ThisRecord.Address),
                            District: Text(ThisRecord.District),
                            TID: Text("'" & ThisRecord.TID & "'"),
                            MID: Text("'" & ThisRecord.MID & "'"),
                            SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                            TerminalType: Text(ThisRecord.TerminalType),
                            Ownership: Text(ThisRecord.Ownership),
                            Status: Text(ThisRecord.Status),
                            CashAdvance: Text(ThisRecord.CashAdvance),
                            PinChange: Text(ThisRecord.PinChange),
                            DaysRun: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        Value(txtNumberOfDays.Text)
                                    );
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            30
                                        );
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text(
                                            If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            );
                                        ),
                                        Text(
                                            If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            );
                                        )
                                    )
                                )
                            ),
                            RentalFee: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    LookUp(
                                        tbl_mst_Rates,
                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                    ).Rate
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text("0"),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate
                                        )
                                    )
                                )
                            ),
                            FinalAmt: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    (If(
                                        ThisRecord.Status = "Retrieval",
                                        If(
                                            ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                            0,
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            Value(txtNumberOfDays.Text)
                                        ) / Value(txtNumberOfDays.Text)
                                    ) * LookUp(
                                        tbl_mst_Rates,
                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                    ).Rate);
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                        ).Rate
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            If(
                                                ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                                0,
                                                (If(
                                                    ThisRecord.Status = "Retrieval",
                                                    DateDiff(
                                                        dteFromDate.SelectedDate,
                                                        ThisRecord.deployDate,
                                                        TimeUnit.Days
                                                    ) + 1,
                                                    30
                                                ) / 30) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                ).Rate
                                            );
                                        )
                                    )
                                )
                            )
                        }
                    )
                );
                ClearCollect(
                    colALLDEP,
                    ForAll(
                        colBankData,
                        {
                            Date: DateValue(ThisRecord.deployDate),
                            BankName: Text(ThisRecord.bankName),
                            MerchantName: Text(ThisRecord.MerchantName),
                            Address: Text(ThisRecord.Address),
                            District: Text(ThisRecord.District),
                            TID: Text("'" & ThisRecord.TID & "'"),
                            MID: Text("'" & ThisRecord.MID & "'"),
                            SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                            TerminalType: Text(ThisRecord.TerminalType),
                            Ownership: Text(ThisRecord.Ownership),
                            Status: Text(ThisRecord.Status),
                            CashAdvance: Text(ThisRecord.CashAdvance),
                            PinChange: Text(ThisRecord.PinChange),
                            DaysRun: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            Value(txtNumberOfDays.Text),
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > Value(txtNumberOfDays.Text),
                                                Value(txtNumberOfDays.Text),
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1)
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                            Value(txtNumberOfDays.Text)
                                        )
                                    );
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        If(
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                30,
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > 30,
                                                    30,
                                                    DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                30
                                            )
                                        );
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30,
                                                        DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30
                                                )
                                            );
                                        ),
                                        Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30,
                                                        DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30
                                                )
                                            );
                                        )
                                    )
                                )
                            ),
                            RentalFee: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    LookUp(
                                        tbl_mst_Rates,
                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                    ).Rate
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                        ).Rate
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate
                                        )
                                    )
                                )
                            ),
                            FinalAmt: If(
                                ThisRecord.bankName = "MACHHAPUCHCHHRE BANK LTD.",
                                Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate,
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > Value(txtNumberOfDays.Text),
                                                Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                ).Rate,
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) / Value(txtNumberOfDays.Text) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                ).Rate
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                            Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                            ).Rate
                                        )
                                    )
                                ),
                                If(
                                    ThisRecord.bankName = "NABIL BANK LTD." Or ThisRecord.bankName = "NEPAL BANK LTD.",
                                    Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                        ).Rate
                                    ),
                                    If(
                                        ThisRecord.bankName = "NEPAL SBI BANK LTD.",
                                        Text("-"),
                                        Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30 / 30 * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                    ).Rate,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30 / 30 * LookUp(
                                                            tbl_mst_Rates,
                                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                        ).Rate,
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) / 30 * LookUp(
                                                            tbl_mst_Rates,
                                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                        ).Rate
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30 / 30 * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && PinChange
                                                    ).Rate
                                                )
                                            );
                                        )
                                    )
                                )
                            )
                        }
                    )
                );
                ClearCollect(
                    colAllData,
                    colALLDEP
                );
                Collect(
                    colAllData,
                    colALLRET
                );
                Set(
                    glbToggleButton,
                    true
                );
                Notify(
                    "Both Deployed and Retrieved Terminal Synced Successfully",
                    NotificationType.Success
                );
                /*If(
                    drpBankName.SelectedText.Value = "MACHHAPUCHCHHRE BANK LTD.",
                    If(
                        txtNumberOfDays.Text = "",
                        Notify(
                            "Please Enter number of days",
                            NotificationType.Error
                        ),
                        ClearCollect(
                            colBankData,
                            ForAll(
                                Table(parsedData),
                                {
                                    deployDate: Text(Value.deployDate),
                                    bankName: Text(Value.bankName),
                                    MerchantName: Text(Value.merchantName),
                                    Address: Text(Value.merchantAddress),
                                    District: (Value.district),
                                    TID: Text(Value.idTerminal),
                                    MID: Text(Value.idMerchant),
                                    SerialNumber: Text(Value.serialKey),
                                    TerminalType: Text(Value.terminalType),
                                    Ownership: Text(Value.ownership),
                                    Status: Text(Value.deploymentStatus),
                                    CashAdvance: If(
                                        Value.cashAdvance = true,
                                        "True",
                                        "false"
                                    ),
                                    PinChange: Text(
                                        Value.pinChange = true,
                                        "True",
                                        "False"
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colRetBankData,
                            ForAll(
                                Table(parsedRetrieveData),
                                {
                                    deployDate: Text(Value.updatedDate),
                                    bankName: Text(Value.bankName),
                                    MerchantName: Text(Value.merchant),
                                    Address: Text(Value.address),
                                    District: (Value.district),
                                    TID: Text(Value.idTerminal),
                                    MID: Text(Value.idMerchant),
                                    SerialNumber: Text(Value.serialNumber),
                                    TerminalType: Text(Value.terminalType),
                                    Ownership: Text(Value.ownership),
                                    Status: Text(Value.teminalStatus),
                                    CashAdvance: If(
                                        Value.cashAdvance = true,
                                        "True",
                                        "false"
                                    ),
                                    PinChange: Text(
                                        Value.pinChange = true,
                                        "True",
                                        "False"
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colALLRET,
                            ForAll(
                                colRetBankData,
                                {
                                    Date: DateValue(ThisRecord.deployDate),
                                    BankName: Text(ThisRecord.bankName),
                                    MerchantName: Text(ThisRecord.MerchantName),
                                    Address: Text(ThisRecord.Address),
                                    District: Text(ThisRecord.District),
                                    TID: Text("'" & ThisRecord.TID & "'"),
                                    MID: Text("'" & ThisRecord.MID & "'"),
                                    SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                    TerminalType: Text(ThisRecord.TerminalType),
                                    Ownership: Text(ThisRecord.Ownership),
                                    Status: Text(ThisRecord.Status),
                                    CashAdvance: Text(ThisRecord.CashAdvance),
                                    PinChange: Text(ThisRecord.PinChange),
                                    DaysRun: Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            Value(txtNumberOfDays.Text)
                                        );
                                    ),
                                    RentalFee: Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership
                                        ).Rate
                                    ),
                                    FinalAmt: Text(
                                        (If(
                                            ThisRecord.Status = "Retrieval",
                                            If(
                                                ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                                0,
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                Value(txtNumberOfDays.Text)
                                            ) / Value(txtNumberOfDays.Text)
                                        ) * LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                        ).Rate);
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colALLDEP,
                            ForAll(
                                colBankData,
                                {
                                    Date: DateValue(ThisRecord.deployDate),
                                    BankName: Text(ThisRecord.bankName),
                                    MerchantName: Text(ThisRecord.MerchantName),
                                    Address: Text(ThisRecord.Address),
                                    District: Text(ThisRecord.District),
                                    TID: Text("'" & ThisRecord.TID & "'"),
                                    MID: Text("'" & ThisRecord.MID & "'"),
                                    SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                    TerminalType: Text(ThisRecord.TerminalType),
                                    Ownership: Text(ThisRecord.Ownership),
                                    Status: Text(ThisRecord.Status),
                                    CashAdvance: Text(ThisRecord.CashAdvance),
                                    PinChange: Text(ThisRecord.PinChange),
                                    DaysRun: Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                Value(txtNumberOfDays.Text),
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > Value(txtNumberOfDays.Text),
                                                    Value(txtNumberOfDays.Text),
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1)
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                Value(txtNumberOfDays.Text)
                                            )
                                        );
                                    ),
                                    RentalFee: Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                        ).Rate
                                    ),
                                    FinalAmt: Text(
                                        If(
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                ).Rate,
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > Value(txtNumberOfDays.Text),
                                                    Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                    ).Rate,
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) / Value(txtNumberOfDays.Text) * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                    ).Rate
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                ).Rate
                                            )
                                        )
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colAllData,
                            colALLDEP
                        );
                        Collect(
                            colAllData,
                            colALLRET
                        );
                        Set(
                            glbToggleButton,
                            true
                        );
                        Notify(
                            "Both Deployed and Retrieved Terminal Synced Successfully",
                            NotificationType.Success
                        )
                    ),
                    If(
                        drpBankName.SelectedText.Value = "NABIL BANK LTD." Or drpBankName.SelectedText.Value = "NEPAL BANK LTD.",
                        ClearCollect(
                            colBankData,
                            ForAll(
                                Table(parsedData),
                                {
                                    deployDate: Text(Value.deployDate),
                                    bankName: Text(Value.bankName),
                                    MerchantName: Text(Value.merchantName),
                                    Address: Text(Value.merchantAddress),
                                    District: (Value.district),
                                    TID: Text(Value.idTerminal),
                                    MID: Text(Value.idMerchant),
                                    SerialNumber: Text(Value.serialKey),
                                    TerminalType: Text(Value.terminalType),
                                    Ownership: Text(Value.ownership),
                                    Status: Text(Value.deploymentStatus),
                                    CashAdvance: If(
                                        Value.cashAdvance = true,
                                        "True",
                                        "false"
                                    ),
                                    PinChange: Text(
                                        Value.pinChange = true,
                                        "True",
                                        "False"
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colRetBankData,
                            ForAll(
                                Table(parsedRetrieveData),
                                {
                                    deployDate: Text(Value.updatedDate),
                                    bankName: Text(Value.bankName),
                                    MerchantName: Text(Value.merchant),
                                    Address: Text(Value.address),
                                    District: (Value.district),
                                    TID: Text(Value.idTerminal),
                                    MID: Text(Value.idMerchant),
                                    SerialNumber: Text(Value.serialNumber),
                                    TerminalType: Text(Value.terminalType),
                                    Ownership: Text(Value.ownership),
                                    Status: Text(Value.teminalStatus),
                                    CashAdvance: If(
                                        Value.cashAdvance = true,
                                        "True",
                                        "False"
                                    ),
                                    PinChange: Text(
                                        Value.pinChange = true,
                                        "True",
                                        "False"
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colALLRET,
                            ForAll(
                                colRetBankData,
                                {
                                    Date: DateValue(ThisRecord.deployDate),
                                    BankName: Text(ThisRecord.bankName),
                                    MerchantName: Text(ThisRecord.MerchantName),
                                    Address: Text(ThisRecord.Address),
                                    District: Text(ThisRecord.District),
                                    TID: Text("'" & ThisRecord.TID & "'"),
                                    MID: Text("'" & ThisRecord.MID & "'"),
                                    SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                    TerminalType: Text(ThisRecord.TerminalType),
                                    Ownership: Text(ThisRecord.Ownership),
                                    Status: Text(ThisRecord.Status),
                                    DaysRun: Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            30
                                        );
                                    ),
                                    RentalFee: Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership
                                        ).Rate
                                    ),
                                    FinalAmt: Text(0)
                                }
                            )
                        );
                        ClearCollect(
                            colALLDEP,
                            ForAll(
                                colBankData,
                                {
                                    Date: DateValue(ThisRecord.deployDate),
                                    BankName: Text(ThisRecord.bankName),
                                    MerchantName: Text(ThisRecord.MerchantName),
                                    Address: Text(ThisRecord.Address),
                                    District: Text(ThisRecord.District),
                                    TID: Text("'" & ThisRecord.TID & "'"),
                                    MID: Text("'" & ThisRecord.MID & "'"),
                                    SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                    TerminalType: Text(ThisRecord.TerminalType),
                                    Ownership: Text(ThisRecord.Ownership),
                                    Status: Text(ThisRecord.Status),
                                    DaysRun: Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                30,
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > 30,
                                                    30,
                                                    DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                30
                                            )
                                        );
                                    ),
                                    RentalFee: Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                        ).Rate
                                    ),
                                    FinalAmt: Text(
                                        LookUp(
                                            tbl_mst_Rates,
                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                        ).Rate
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colAllData,
                            colALLDEP
                        );
                        Collect(
                            colAllData,
                            colALLRET
                        );
                        Set(
                            glbToggleButton,
                            true
                        );
                        Notify(
                            "Both Deployed and Retrieved Terminal Synced Successfully",
                            NotificationType.Success
                        );
                        ,
                        If(
                            drpBankName.SelectedText.Value = "NEPAL SBI BANK LTD.",
                            ClearCollect(
                                colBankData,
                                ForAll(
                                    Table(parsedData),
                                    {
                                        deployDate: Text(Value.deployDate),
                                        bankName: Text(Value.bankName),
                                        MerchantName: Text(Value.merchantName),
                                        Address: Text(Value.merchantAddress),
                                        District: (Value.district),
                                        TID: Text(Value.idTerminal),
                                        MID: Text(Value.idMerchant),
                                        SerialNumber: Text(Value.serialKey),
                                        TerminalType: Text(Value.terminalType),
                                        Ownership: Text(Value.ownership),
                                        Status: Text(Value.deploymentStatus),
                                        CashAdvance: If(
                                            Value.cashAdvance = true,
                                            "True",
                                            "False"
                                        ),
                                        PinChange: Text(
                                            Value.pinChange = true,
                                            "True",
                                            "False"
                                        )
                                    }
                                )
                            );
                            ClearCollect(
                                colRetBankData,
                                ForAll(
                                    Table(parsedRetrieveData),
                                    {
                                        deployDate: Text(Value.updatedDate),
                                        bankName: Text(Value.bankName),
                                        MerchantName: Text(Value.merchant),
                                        Address: Text(Value.address),
                                        District: (Value.district),
                                        TID: Text(Value.idTerminal),
                                        MID: Text(Value.idMerchant),
                                        SerialNumber: Text(Value.serialNumber),
                                        TerminalType: Text(Value.terminalType),
                                        Ownership: Text(Value.ownership),
                                        Status: Text(Value.teminalStatus),
                                        CashAdvance: If(
                                            Value.cashAdvance = true,
                                            "True",
                                            "false"
                                        ),
                                        PinChange: Text(
                                            Value.pinChange = true,
                                            "True",
                                            "False"
                                        )
                                    }
                                )
                            );
                            ClearCollect(
                                colALLRET,
                                ForAll(
                                    colRetBankData,
                                    {
                                        Date: DateValue(ThisRecord.deployDate),
                                        BankName: Text(ThisRecord.bankName),
                                        MerchantName: Text(ThisRecord.MerchantName),
                                        Address: Text(ThisRecord.Address),
                                        District: Text(ThisRecord.District),
                                        TID: Text("'" & ThisRecord.TID & "'"),
                                        MID: Text("'" & ThisRecord.MID & "'"),
                                        SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                        TerminalType: Text(ThisRecord.TerminalType),
                                        Ownership: Text(ThisRecord.Ownership),
                                        Status: Text(ThisRecord.Status),
                                        DaysRun: Text(
                                            If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            );
                                        ),
                                        RentalFee: Text("-"),
                                        FinalAmt: Text("-")
                                    }
                                )
                            );
                            ClearCollect(
                                colALLDEP,
                                ForAll(
                                    colBankData,
                                    {
                                        Date: DateValue(ThisRecord.deployDate),
                                        BankName: Text(ThisRecord.bankName),
                                        MerchantName: Text(ThisRecord.MerchantName),
                                        Address: Text(ThisRecord.Address),
                                        District: Text(ThisRecord.District),
                                        TID: Text("'" & ThisRecord.TID & "'"),
                                        MID: Text("'" & ThisRecord.MID & "'"),
                                        SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                        TerminalType: Text(ThisRecord.TerminalType),
                                        Ownership: Text(ThisRecord.Ownership),
                                        Status: Text(ThisRecord.Status),
                                        DaysRun: Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30,
                                                        DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30
                                                )
                                            );
                                        ),
                                        RentalFee: Text("-"),
                                        FinalAmt: Text("-")
                                    }
                                )
                            );
                            ClearCollect(
                                colAllData,
                                colALLDEP
                            );
                            Collect(
                                colAllData,
                                colALLRET
                            );
                            Set(
                                glbToggleButton,
                                true
                            );
                            Notify(
                                "Both Deployed and Retrieved Terminal Synced Successfully",
                                NotificationType.Success
                            );
                            ,
                            ClearCollect(
                                colBankData,
                                ForAll(
                                    Table(parsedData),
                                    {
                                        deployDate: Text(Value.deployDate),
                                        bankName: Text(Value.bankName),
                                        MerchantName: Text(Value.merchantName),
                                        Address: Text(Value.merchantAddress),
                                        District: (Value.district),
                                        TID: Text(Value.idTerminal),
                                        MID: Text(Value.idMerchant),
                                        SerialNumber: Text(Value.serialKey),
                                        TerminalType: Text(Value.terminalType),
                                        Ownership: Text(Value.ownership),
                                        Status: Text(Value.deploymentStatus),
                                        CashAdvance: If(
                                            Value.cashAdvance = true,
                                            "True",
                                            "False"
                                        ),
                                        PinChange: Text(
                                            Value.pinChange = true,
                                            "True",
                                            "False"
                                        )
                                    }
                                )
                            );
                            ClearCollect(
                                colRetBankData,
                                ForAll(
                                    Table(parsedRetrieveData),
                                    {
                                        deployDate: Text(Value.updatedDate),
                                        bankName: Text(Value.bankName),
                                        MerchantName: Text(Value.merchant),
                                        Address: Text(Value.address),
                                        District: (Value.district),
                                        TID: Text(Value.idTerminal),
                                        MID: Text(Value.idMerchant),
                                        SerialNumber: Text(Value.serialNumber),
                                        TerminalType: Text(Value.terminalType),
                                        Ownership: Text(Value.ownership),
                                        Status: Text(Value.teminalStatus),
                                        CashAdvance: If(
                                            Value.cashAdvance = true,
                                            "True",
                                            "False"
                                        ),
                                        PinChange: Text(
                                            Value.pinChange = true,
                                            "True",
                                            "False"
                                        )
                                    }
                                )
                            );
                            ClearCollect(
                                colALLRET,
                                ForAll(
                                    colRetBankData,
                                    {
                                        Date: DateValue(ThisRecord.deployDate),
                                        BankName: Text(ThisRecord.bankName),
                                        MerchantName: Text(ThisRecord.MerchantName),
                                        Address: Text(ThisRecord.Address),
                                        District: Text(ThisRecord.District),
                                        TID: Text("'" & ThisRecord.TID & "'"),
                                        MID: Text("'" & ThisRecord.MID & "'"),
                                        SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                        TerminalType: Text(ThisRecord.TerminalType),
                                        Ownership: Text(ThisRecord.Ownership),
                                        Status: Text(ThisRecord.Status),
                                        DaysRun: Text(
                                            If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            );
                                        ),
                                        RentalFee: Text(
                                            LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership
                                            ).Rate
                                        ),
                                        FinalAmt: Text(
                                            If(
                                                ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                                0,
                                                (If(
                                                    ThisRecord.Status = "Retrieval",
                                                    DateDiff(
                                                        dteFromDate.SelectedDate,
                                                        ThisRecord.deployDate,
                                                        TimeUnit.Days
                                                    ) + 1,
                                                    30
                                                ) / 30) * LookUp(
                                                    tbl_mst_Rates,
                                                    ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                ).Rate
                                            );
                                        )
                                    }
                                )
                            );
                            ClearCollect(
                                colALLDEP,
                                ForAll(
                                    colBankData,
                                    {
                                        Date: DateValue(ThisRecord.deployDate),
                                        BankName: Text(ThisRecord.bankName),
                                        MerchantName: Text(ThisRecord.MerchantName),
                                        Address: Text(ThisRecord.Address),
                                        District: Text(ThisRecord.District),
                                        TID: Text("'" & ThisRecord.TID & "'"),
                                        MID: Text("'" & ThisRecord.MID & "'"),
                                        SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                        TerminalType: Text(ThisRecord.TerminalType),
                                        Ownership: Text(ThisRecord.Ownership),
                                        Status: Text(ThisRecord.Status),
                                        DaysRun: Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30,
                                                        DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30
                                                )
                                            );
                                        ),
                                        RentalFee: Text(
                                            LookUp(
                                                tbl_mst_Rates,
                                                ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                            ).Rate
                                        ),
                                        FinalAmt: Text(
                                            If(
                                                ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                                If(
                                                    DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                    30 / 30 * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                    ).Rate,
                                                    If(
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) > 30,
                                                        30 / 30 * LookUp(
                                                            tbl_mst_Rates,
                                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                        ).Rate,
                                                        (DateDiff(
                                                            ThisRecord.deployDate,
                                                            dteToDate.SelectedDate,
                                                            TimeUnit.Days
                                                        ) + 1) / 30 * LookUp(
                                                            tbl_mst_Rates,
                                                            ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                        ).Rate
                                                    )
                                                ),
                                                If(
                                                    ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested" Or ThisRecord.Status = "ReplacementConfigured",
                                                    30 / 30 * LookUp(
                                                        tbl_mst_Rates,
                                                        ThisRecord.'Bank Names' = Text(drpBankName.SelectedText.Value) && ThisRecord.TerminalTypes = TerminalType && ThisRecord.Property = Ownership && ThisRecord.'Cash Advance' = CashAdvance && ThisRecord.PinChange = PinChange
                                                    ).Rate
                                                )
                                            );
                                        )
                                    }
                                )
                            );
                            ClearCollect(
                                colAllData,
                                colALLDEP
                            );
                            Collect(
                                colAllData,
                                colALLRET
                            );
                            Set(
                                glbToggleButton,
                                true
                            );
                            Notify(
                                "Both Deployed and Retrieved Terminal Synced Successfully",
                                NotificationType.Success
                            );
                        )
                    )
                )*/
            );
        Text: ="Fetch Data"
        Width: =171
        X: =45
        Y: =682
        ZIndex: =4

    dteFromDate As datepicker:
        DefaultDate: =First(tbl_Dates).DateFrom
        Height: =38
        Width: =200
        X: =416
        Y: =584
        ZIndex: =5

    dteToDate As datepicker:
        DefaultDate: =DateValue(First(tbl_Dates).DateTo)
        Height: =38
        Width: =200
        X: =660
        Y: =584
        ZIndex: =6

    lblStartDate As label:
        Height: =38
        Text: ="Start Date"
        Width: =126
        X: =416
        Y: =546
        ZIndex: =7

    lblEndDate As label:
        Height: =38
        Text: |-
            ="EndDate
            "
        Width: =91
        X: =660
        Y: =546
        ZIndex: =8

    btnExportToExcel As button:
        DisplayMode: |-
            =//If(glbToggleButton,DisplayMode.Edit,DisplayMode.Disabled)
            DisplayMode.Edit
        OnSelect: |-
            =ClearCollect(
                colExportToExcel,
                Filter(
                    colAllData,
                    ThisRecord.Date < dteToDate.SelectedDate
                )
            );
            // Define the specific column order you want
            /*ClearCollect(
                colExportToExcelOrdered,
                AddColumns(
                    colExportToExcel,
                    "ColumnOrder",
                    [
                        "Address",
                        "BankName",
                        "Date",
                        "District",
                        "MID",
                        "MerchantName",
                        "Ownership",
                        "RentalFee",
                        "SerialNo",
                        "Status",
                        "TID",
                        "TerminalType",
                        "DaysRun",
                        "FinalAmt"
                    ]// Add other columns as needed
                )
            );*/
            ExportToExcel.Run(
                JSON(colExportToExcel),
                "All Bank",
                LookUp(
                    tbl_mst_Emails,
                    drpBankName.SelectedText.Value = BankName
                ).PrimaryEmail,
                LookUp(
                    tbl_mst_Emails,
                    drpBankName.SelectedText.Value = BankName
                ).SecondaryEmail
            );
            Notify(
                "Exported to excel successfully!!!",
                NotificationType.Success
            );
        Text: ="Export to Excel"
        Visible: =If(drpBankName.SelectedText.Value="All Bank", true, false)
        X: =236
        Y: =682
        ZIndex: =10

    lblSelectDate As label:
        Text: |-
            ="Select Bank
            "
        X: =49
        Y: =542
        ZIndex: =11

    txtNumberOfDays As text:
        Default: =""
        HintText: ="Actual No. Of Days"
        Visible: =locTogText
        X: =902
        Y: =582
        ZIndex: =13

    lblNoOfDays As label:
        Text: ="Actual No. of Days"
        Visible: =locTogText
        Width: =168
        X: =902
        Y: =542
        ZIndex: =14

    "'Generate Invoice' As button":
        DisplayMode: =If(glbToggleButton,DisplayMode.Edit,DisplayMode.Disabled)
        OnSelect: =Navigate(InoviceScreen,ScreenTransition.Fade);
        Text: ="Generate Invoice"
        Visible: =If(drpBankName.SelectedText.Value="All Bank", false, true)
        Width: =193
        X: =236
        Y: =682
        ZIndex: =15

