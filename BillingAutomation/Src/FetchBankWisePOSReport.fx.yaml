FetchBankWisePOSReport As screen:

    containerGalleryBankWisePOSDetail As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Bold
        Height: =500
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        RadiusBottomLeft: =12
        RadiusBottomRight: =12
        RadiusTopLeft: =12
        RadiusTopRight: =12
        Width: =1366
        ZIndex: =2

        conrainerHeader As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(39, 67, 125, 1)
            FillPortions: =0
            Height: =100
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =32
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =2900
            ZIndex: =1

            lblDate As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Date
                    "
                Width: =100
                ZIndex: =1

            lblBanksName As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Bank Name
                    "
                Width: =180
                ZIndex: =2

            lblMerchantName As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Merchant Name
                    "
                Width: =220
                ZIndex: =3

            lblAddress As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Address
                    "
                Width: =120
                ZIndex: =4

            lblDistrict As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="District
                    "
                Width: =110
                ZIndex: =5

            lblTID As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="TID
                    "
                Width: =80
                ZIndex: =6

            lblMID As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="MID
                    "
                ZIndex: =7

            lblSerialNo As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Serial No.
                    "
                Width: =180
                ZIndex: =8

            lblTerminalTypes As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Terminal Type
                    "
                Width: =200
                ZIndex: =9

            lblOwnership As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Ownership
                    "
                Width: =160
                ZIndex: =10

            lblStatus As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Status
                    "
                Width: =120
                ZIndex: =11

            lblRentalFee As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Rental Fee
                    "
                Width: =160
                ZIndex: =12

            lblDaysRun As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: |-
                    ="Days Run
                    "
                Width: =160
                ZIndex: =13

            lblCashAdvance As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="Cash Adv"
                Width: =140
                ZIndex: =14

            lblPinChange As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="Pin Change"
                Width: =160
                ZIndex: =15

            lblFinalAmt_2 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Size: =20
                Text: ="FinalAmt"
                Width: =140
                ZIndex: =16

        "galBankWisePOSDetail As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            AlignInContainer: =AlignInContainer.SetByContainer
            DelayItemLoading: =true
            FillPortions: =0
            Height: =400
            Items: =Filter(colAllData, BankName = drpBankName.SelectedText.Value And ThisRecord.Date<dteToDate.SelectedDate)
            Layout: =Layout.Vertical
            LayoutMinHeight: =287
            LayoutMinWidth: =320
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =104
            Width: =2900
            ZIndex: =2

            lblBankNameContent As label:
                Align: =Align.Center
                Height: =47
                OnSelect: =Select(Parent)
                Text: =ThisItem.BankName
                Width: =206
                X: =109
                Y: =24
                ZIndex: =1

            lblDateContent As label:
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Date
                Width: =117
                X: =3
                Y: =24
                ZIndex: =2

            lblMerchantNameContent As label:
                Align: =Align.Center
                Height: =68
                OnSelect: =Select(Parent)
                Text: =ThisItem.MerchantName
                Width: =283
                X: =308
                Y: =17
                ZIndex: =3

            lblDistrictContent As label:
                Align: =Align.Center
                Height: =64
                OnSelect: =Select(Parent)
                Text: =ThisItem.District
                Width: =154
                X: =737
                Y: =21
                ZIndex: =5

            lblTIDContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.TID
                Width: =147
                X: =875
                Y: =30
                ZIndex: =6

            lblMIDContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.MID
                Width: =184
                X: =1015
                Y: =30
                ZIndex: =7

            lblSerialNoContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.SerialNo
                Width: =195
                X: =1205
                Y: =30
                ZIndex: =8

            lblTerminalTypeContent As label:
                Align: =Align.Center
                Height: =70
                OnSelect: =Select(Parent)
                Text: =ThisItem.TerminalType
                Width: =223
                X: =1407
                Y: =15
                ZIndex: =9

            lblOwnershipContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Ownership
                Width: =167
                X: =1630
                Y: =24
                ZIndex: =10

            lblStatusContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.Status
                Width: =156
                X: =1819
                Y: =24
                ZIndex: =11

            lblDaysRunContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.DaysRun
                Width: =147
                X: =2175
                Y: =24
                ZIndex: =12

            lblRentalFeeContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.RentalFee
                Width: =147
                X: =1991
                Y: =24
                ZIndex: =13

            lblFinalAmtContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =ThisItem.FinalAmt
                Width: =147
                X: =2746
                Y: =24
                ZIndex: =14

            lblAddressContent As label:
                Align: =Align.Center
                Height: =67
                OnSelect: =Select(Parent)
                Text: =ThisItem.Address
                Width: =164
                X: =582
                Y: =21
                ZIndex: =15

            lblCashAdvanceContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =If(ThisItem.CashAdvance,"True", "False")
                Width: =147
                X: =2364
                Y: =24
                ZIndex: =16

            lblPinChangeContent As label:
                Align: =Align.Center
                Height: =46
                OnSelect: =Select(Parent)
                Text: =If(ThisItem.PinChange,"True", "False")
                Width: =147
                X: =2544
                Y: =25
                ZIndex: =17

    drpBankName As dropdown:
        Items: =tbl_mst_Banks
        OnChange: |-
            =If(drpBankName.SelectedText.Value="MACHHAPUCHCHHRE BANK LTD.",UpdateContext({locTogText:true}),UpdateContext({locTogText:false}));
            Clear(colAllData);
        OnSelect: =
        X: =7
        Y: =603
        ZIndex: =3

    btnFetchData As button:
        OnSelect: |
            =Set(
                glbToggleButton,
                false
            );
            RemoveIf(
                tbl_Dates,
                true
            );
            Patch(
                tbl_Dates,
                Defaults(tbl_Dates),
                {
                    DateFrom: dteFromDate.SelectedDate,
                    DateTo: dteToDate.SelectedDate
                }
            );
            UpdateContext({locDateFrom: DateValue(First(tbl_Dates).DateFrom)});
            Set(
                BankData,
                BankWisePOSReportsFlow.Run(
                    dteFromDate.SelectedDate,
                    dteToDate.SelectedDate
                )
            );
            Set(
                parsedData,
                ParseJSON(BankData.output)
            );
            Set(
                parsedRetrieveData,
                ParseJSON(BankData.outputretrieveterminal)
            );
            If(
                drpBankName.SelectedText.Value = "MACHHAPUCHCHHRE BANK LTD.",
                If(
                    txtNumberOfDays.Text = "",
                    Notify(
                        "Please Enter number of days",
                        NotificationType.Error
                    ),
                    ClearCollect(
                        colBankData,
                        ForAll(
                            Table(parsedData),
                            {
                                deployDate: Text(Value.deployDate),
                                bankName: Text(Value.bankName),
                                MerchantName: Text(Value.merchantName),
                                Address: Text(Value.merchantAddress),
                                District: (Value.district),
                                TID: Text(Value.idTerminal),
                                MID: Text(Value.idMerchant),
                                SerialNumber: Text(Value.serialKey),
                                TerminalType: Text(Value.terminalType),
                                Ownership: Text(Value.ownership),
                                Status: Text(Value.deploymentStatus),
                                CashAdvance: If(
                                    Value.cashAdvance = true,
                                    "True",
                                    "false"
                                ),
                                PinChange: Text(
                                    Value.pinChange = true,
                                    "True",
                                    "False"
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colRetBankData,
                        ForAll(
                            Table(parsedRetrieveData),
                            {
                                deployDate: Text(Value.updatedDate),
                                bankName: Text(Value.bankName),
                                MerchantName: Text(Value.merchant),
                                Address: Text(Value.address),
                                District: (Value.district),
                                TID: Text(Value.idTerminal),
                                MID: Text(Value.idMerchant),
                                SerialNumber: Text(Value.serialNumber),
                                TerminalType: Text(Value.terminalType),
                                Ownership: Text(Value.ownership),
                                Status: Text(Value.teminalStatus),
                                CashAdvance: If(
                                    Value.cashAdvance = true,
                                    "True",
                                    "false"
                                ),
                                PinChange: Text(
                                    Value.pinChange = true,
                                    "True",
                                    "False"
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colALLRET,
                        ForAll(
                            colRetBankData,
                            {
                                Date: DateValue(ThisRecord.deployDate),
                                BankName: Text(ThisRecord.bankName),
                                MerchantName: Text(ThisRecord.MerchantName),
                                Address: Text(ThisRecord.Address),
                                District: Text(ThisRecord.District),
                                TID: Text(ThisRecord.TID),
                                MID: Text("'" & ThisRecord.MID & "'"),
                                SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                TerminalType: Text(ThisRecord.TerminalType),
                                Ownership: Text(ThisRecord.Ownership),
                                Status: Text(ThisRecord.Status),
                                CashAdvance: Text(ThisRecord.CashAdvance),
                                PinChange: Text(ThisRecord.PinChange),
                                DaysRun: Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        Value(txtNumberOfDays.Text)
                                    );
                                ),
                                RentalFee: Text(900),
                                FinalAmt: Text(
                                    (If(
                                        ThisRecord.Status = "Retrieval",
                                        If(
                                            ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                            0,
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            Value(txtNumberOfDays.Text)
                                        ) / Value(txtNumberOfDays.Text)
                                    ) * 900);
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colALLDEP,
                        ForAll(
                            colBankData,
                            {
                                Date: DateValue(ThisRecord.deployDate),
                                BankName: Text(ThisRecord.bankName),
                                MerchantName: Text(ThisRecord.MerchantName),
                                Address: Text(ThisRecord.Address),
                                District: Text(ThisRecord.District),
                                TID: Text(ThisRecord.TID),
                                MID: Text("'" & ThisRecord.MID & "'"),
                                SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                TerminalType: Text(ThisRecord.TerminalType),
                                Ownership: Text(ThisRecord.Ownership),
                                Status: Text(ThisRecord.Status),
                                CashAdvance: Text(ThisRecord.CashAdvance),
                                PinChange: Text(ThisRecord.PinChange),
                                DaysRun: Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            Value(txtNumberOfDays.Text),
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > Value(txtNumberOfDays.Text),
                                                Value(txtNumberOfDays.Text),
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1)
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                            Value(txtNumberOfDays.Text)
                                        )
                                    );
                                ),
                                RentalFee: Text(900),
                                FinalAmt: Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * 900,
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > Value(txtNumberOfDays.Text),
                                                Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * 900,
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) / Value(txtNumberOfDays.Text) * 900
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                            Value(txtNumberOfDays.Text) / Value(txtNumberOfDays.Text) * 900
                                        )
                                    )
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colAllData,
                        colALLDEP
                    );
                    Collect(
                        colAllData,
                        colALLRET
                    );
                    Set(
                        glbToggleButton,
                        true
                    );
                    Notify(
                        "Both Deployed and Retrieved Terminal Synced Successfully",
                        NotificationType.Success
                    )
                ),
                If(
                    drpBankName.SelectedText.Value = "NABIL BANK LTD." Or drpBankName.SelectedText.Value = "NEPAL BANK LTD.",
                    ClearCollect(
                        colBankData,
                        ForAll(
                            Table(parsedData),
                            {
                                deployDate: Text(Value.deployDate),
                                bankName: Text(Value.bankName),
                                MerchantName: Text(Value.merchantName),
                                Address: Text(Value.merchantAddress),
                                District: (Value.district),
                                TID: Text(Value.idTerminal),
                                MID: Text(Value.idMerchant),
                                SerialNumber: Text(Value.serialKey),
                                TerminalType: Text(Value.terminalType),
                                Ownership: Text(Value.ownership),
                                Status: Text(Value.deploymentStatus),
                                CashAdvance: If(
                                    Value.cashAdvance = true,
                                    "True",
                                    "false"
                                ),
                                PinChange: Text(
                                    Value.pinChange = true,
                                    "True",
                                    "False"
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colRetBankData,
                        ForAll(
                            Table(parsedRetrieveData),
                            {
                                deployDate: Text(Value.updatedDate),
                                bankName: Text(Value.bankName),
                                MerchantName: Text(Value.merchant),
                                Address: Text(Value.address),
                                District: (Value.district),
                                TID: Text(Value.idTerminal),
                                MID: Text(Value.idMerchant),
                                SerialNumber: Text(Value.serialNumber),
                                TerminalType: Text(Value.terminalType),
                                Ownership: Text(Value.ownership),
                                Status: Text(Value.teminalStatus),
                                CashAdvance: If(
                                    Value.cashAdvance = true,
                                    "True",
                                    "false"
                                ),
                                PinChange: Text(
                                    Value.pinChange = true,
                                    "True",
                                    "False"
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colALLRET,
                        ForAll(
                            colRetBankData,
                            {
                                Date: DateValue(ThisRecord.deployDate),
                                BankName: Text(ThisRecord.bankName),
                                MerchantName: Text(ThisRecord.MerchantName),
                                Address: Text(ThisRecord.Address),
                                District: Text(ThisRecord.District),
                                TID: Text(ThisRecord.TID),
                                MID: Text("'" & ThisRecord.MID & "'"),
                                SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                TerminalType: Text(ThisRecord.TerminalType),
                                Ownership: Text(ThisRecord.Ownership),
                                Status: Text(ThisRecord.Status),
                                DaysRun: Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        30
                                    );
                                ),
                                RentalFee: Text(900),
                                FinalAmt: Text(0)
                            }
                        )
                    );
                    ClearCollect(
                        colALLDEP,
                        ForAll(
                            colBankData,
                            {
                                Date: DateValue(ThisRecord.deployDate),
                                BankName: Text(ThisRecord.bankName),
                                MerchantName: Text(ThisRecord.MerchantName),
                                Address: Text(ThisRecord.Address),
                                District: Text(ThisRecord.District),
                                TID: Text(ThisRecord.TID),
                                MID: Text("'" & ThisRecord.MID & "'"),
                                SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                TerminalType: Text(ThisRecord.TerminalType),
                                Ownership: Text(ThisRecord.Ownership),
                                Status: Text(ThisRecord.Status),
                                DaysRun: Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            30,
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > 30,
                                                30,
                                                DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                            30
                                        )
                                    );
                                ),
                                RentalFee: Text(900),
                                FinalAmt: Text(900)
                            }
                        )
                    );
                    ClearCollect(
                        colAllData,
                        colALLDEP
                    );
                    Collect(
                        colAllData,
                        colALLRET
                    );
                    Set(
                        glbToggleButton,
                        true
                    );
                    Notify(
                        "Both Deployed and Retrieved Terminal Synced Successfully",
                        NotificationType.Success
                    );
                    ,
                    If(
                        drpBankName.SelectedText.Value = "NEPAL SBI BANK LTD.",
                        ClearCollect(
                            colBankData,
                            ForAll(
                                Table(parsedData),
                                {
                                    deployDate: Text(Value.deployDate),
                                    bankName: Text(Value.bankName),
                                    MerchantName: Text(Value.merchantName),
                                    Address: Text(Value.merchantAddress),
                                    District: (Value.district),
                                    TID: Text(Value.idTerminal),
                                    MID: Text(Value.idMerchant),
                                    SerialNumber: Text(Value.serialKey),
                                    TerminalType: Text(Value.terminalType),
                                    Ownership: Text(Value.ownership),
                                    Status: Text(Value.deploymentStatus),
                                    CashAdvance: If(
                                        Value.cashAdvance = true,
                                        "True",
                                        "false"
                                    ),
                                    PinChange: Text(
                                        Value.pinChange = true,
                                        "True",
                                        "False"
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colRetBankData,
                            ForAll(
                                Table(parsedRetrieveData),
                                {
                                    deployDate: Text(Value.updatedDate),
                                    bankName: Text(Value.bankName),
                                    MerchantName: Text(Value.merchant),
                                    Address: Text(Value.address),
                                    District: (Value.district),
                                    TID: Text(Value.idTerminal),
                                    MID: Text(Value.idMerchant),
                                    SerialNumber: Text(Value.serialNumber),
                                    TerminalType: Text(Value.terminalType),
                                    Ownership: Text(Value.ownership),
                                    Status: Text(Value.teminalStatus),
                                    CashAdvance: If(
                                        Value.cashAdvance = true,
                                        "True",
                                        "false"
                                    ),
                                    PinChange: Text(
                                        Value.pinChange = true,
                                        "True",
                                        "False"
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colALLRET,
                            ForAll(
                                colRetBankData,
                                {
                                    Date: DateValue(ThisRecord.deployDate),
                                    BankName: Text(ThisRecord.bankName),
                                    MerchantName: Text(ThisRecord.MerchantName),
                                    Address: Text(ThisRecord.Address),
                                    District: Text(ThisRecord.District),
                                    TID: Text(ThisRecord.TID),
                                    MID: Text("'" & ThisRecord.MID & "'"),
                                    SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                    TerminalType: Text(ThisRecord.TerminalType),
                                    Ownership: Text(ThisRecord.Ownership),
                                    Status: Text(ThisRecord.Status),
                                    DaysRun: Text(
                                        If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            30
                                        );
                                    ),
                                    RentalFee: Text(900),
                                    FinalAmt: Text(
                                        If(
                                            ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                            0,
                                            (If(
                                                ThisRecord.Status = "Retrieval",
                                                DateDiff(
                                                    dteFromDate.SelectedDate,
                                                    ThisRecord.deployDate,
                                                    TimeUnit.Days
                                                ) + 1,
                                                30
                                            ) / 30) * 900
                                        );
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colALLDEP,
                            ForAll(
                                colBankData,
                                {
                                    Date: DateValue(ThisRecord.deployDate),
                                    BankName: Text(ThisRecord.bankName),
                                    MerchantName: Text(ThisRecord.MerchantName),
                                    Address: Text(ThisRecord.Address),
                                    District: Text(ThisRecord.District),
                                    TID: Text(ThisRecord.TID),
                                    MID: Text("'" & ThisRecord.MID & "'"),
                                    SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                    TerminalType: Text(ThisRecord.TerminalType),
                                    Ownership: Text(ThisRecord.Ownership),
                                    Status: Text(ThisRecord.Status),
                                    DaysRun: Text(
                                        If(
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                30,
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > 30,
                                                    30,
                                                    DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                                30
                                            )
                                        );
                                    ),
                                    RentalFee: Text(900),
                                    FinalAmt: Text(
                                        If(
                                            ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                            If(
                                                DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                                30 / 30 * 900,
                                                If(
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) > 30,
                                                    30 / 30 * 900,
                                                    (DateDiff(
                                                        ThisRecord.deployDate,
                                                        dteToDate.SelectedDate,
                                                        TimeUnit.Days
                                                    ) + 1) / 30 * 900
                                                )
                                            ),
                                            If(
                                                ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                                30 / 30 * 900
                                            )
                                        );
                                    )
                                }
                            )
                        );
                        ClearCollect(
                            colAllData,
                            colALLDEP
                        );
                        Collect(
                            colAllData,
                            colALLRET
                        );
                        Set(
                            glbToggleButton,
                            true
                        );
                    );
                    ,
                    ClearCollect(
                        colBankData,
                        ForAll(
                            Table(parsedData),
                            {
                                deployDate: Text(Value.deployDate),
                                bankName: Text(Value.bankName),
                                MerchantName: Text(Value.merchantName),
                                Address: Text(Value.merchantAddress),
                                District: (Value.district),
                                TID: Text(Value.idTerminal),
                                MID: Text(Value.idMerchant),
                                SerialNumber: Text(Value.serialKey),
                                TerminalType: Text(Value.terminalType),
                                Ownership: Text(Value.ownership),
                                Status: Text(Value.deploymentStatus),
                                CashAdvance: If(
                                    Value.cashAdvance = true,
                                    "True",
                                    "false"
                                ),
                                PinChange: Text(
                                    Value.pinChange = true,
                                    "True",
                                    "False"
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colRetBankData,
                        ForAll(
                            Table(parsedRetrieveData),
                            {
                                deployDate: Text(Value.updatedDate),
                                bankName: Text(Value.bankName),
                                MerchantName: Text(Value.merchant),
                                Address: Text(Value.address),
                                District: (Value.district),
                                TID: Text(Value.idTerminal),
                                MID: Text(Value.idMerchant),
                                SerialNumber: Text(Value.serialNumber),
                                TerminalType: Text(Value.terminalType),
                                Ownership: Text(Value.ownership),
                                Status: Text(Value.teminalStatus),
                                CashAdvance: If(
                                    Value.cashAdvance = true,
                                    "True",
                                    "false"
                                ),
                                PinChange: Text(
                                    Value.pinChange = true,
                                    "True",
                                    "False"
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colALLRET,
                        ForAll(
                            colRetBankData,
                            {
                                Date: DateValue(ThisRecord.deployDate),
                                BankName: Text(ThisRecord.bankName),
                                MerchantName: Text(ThisRecord.MerchantName),
                                Address: Text(ThisRecord.Address),
                                District: Text(ThisRecord.District),
                                TID: Text(ThisRecord.TID),
                                MID: Text("'" & ThisRecord.MID & "'"),
                                SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                TerminalType: Text(ThisRecord.TerminalType),
                                Ownership: Text(ThisRecord.Ownership),
                                Status: Text(ThisRecord.Status),
                                DaysRun: Text(
                                    If(
                                        ThisRecord.Status = "Retrieval",
                                        DateDiff(
                                            dteFromDate.SelectedDate,
                                            ThisRecord.deployDate,
                                            TimeUnit.Days
                                        ) + 1,
                                        30
                                    );
                                ),
                                RentalFee: Text(900),
                                FinalAmt: Text(
                                    If(
                                        ThisRecord.CashAdvance = "True" Or ThisRecord.PinChange = "True",
                                        0,
                                        (If(
                                            ThisRecord.Status = "Retrieval",
                                            DateDiff(
                                                dteFromDate.SelectedDate,
                                                ThisRecord.deployDate,
                                                TimeUnit.Days
                                            ) + 1,
                                            30
                                        ) / 30) * 900
                                    );
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colALLDEP,
                        ForAll(
                            colBankData,
                            {
                                Date: DateValue(ThisRecord.deployDate),
                                BankName: Text(ThisRecord.bankName),
                                MerchantName: Text(ThisRecord.MerchantName),
                                Address: Text(ThisRecord.Address),
                                District: Text(ThisRecord.District),
                                TID: Text(ThisRecord.TID),
                                MID: Text("'" & ThisRecord.MID & "'"),
                                SerialNo: Text("'" & ThisRecord.SerialNumber & "'"),
                                TerminalType: Text(ThisRecord.TerminalType),
                                Ownership: Text(ThisRecord.Ownership),
                                Status: Text(ThisRecord.Status),
                                DaysRun: Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            30,
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > 30,
                                                30,
                                                DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                            30
                                        )
                                    );
                                ),
                                RentalFee: Text(900),
                                FinalAmt: Text(
                                    If(
                                        ThisRecord.Status = "NewDeployed" Or ThisRecord.Status = "RemovalRequest",
                                        If(
                                            DateValue(ThisRecord.deployDate) < dteFromDate.SelectedDate,
                                            30 / 30 * 900,
                                            If(
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) > 30,
                                                30 / 30 * 900,
                                                (DateDiff(
                                                    ThisRecord.deployDate,
                                                    dteToDate.SelectedDate,
                                                    TimeUnit.Days
                                                ) + 1) / 30 * 900
                                            )
                                        ),
                                        If(
                                            ThisRecord.Status = "ReDeployed" Or ThisRecord.Status = "Reconfigure" Or ThisRecord.Status = "ReplacementRequested",
                                            30 / 30 * 900
                                        )
                                    );
                                )
                            }
                        )
                    );
                    ClearCollect(
                        colAllData,
                        colALLDEP
                    );
                    Collect(
                        colAllData,
                        colALLRET
                    );
                    Set(
                        glbToggleButton,
                        true
                    );
                    Notify(
                        "Both Deployed and Retrieved Terminal Synced Successfully",
                        NotificationType.Success
                    );
                )
            );
        Text: ="Fetch Data"
        X: =137
        Y: =692
        ZIndex: =4

    dteFromDate As datepicker:
        DefaultDate: =First(tbl_Dates).DateFrom
        Height: =38
        Width: =200
        X: =381
        Y: =605
        ZIndex: =5

    dteToDate As datepicker:
        DefaultDate: =DateValue(First(tbl_Dates).DateTo)
        Height: =38
        Width: =200
        X: =625
        Y: =605
        ZIndex: =6

    lblFromDate As label:
        Height: =38
        Text: ="Date from"
        Width: =126
        X: =381
        Y: =567
        ZIndex: =7

    lblToDate As label:
        Height: =38
        Text: |-
            ="Date to
            "
        Width: =91
        X: =625
        Y: =567
        ZIndex: =8

    btnExportToExcel As button:
        DisplayMode: |-
            =//If(glbToggleButton,DisplayMode.Edit,DisplayMode.Disabled)
            DisplayMode.Disabled
        OnSelect: |
            =ClearCollect(
                colExportToExcel,
                Filter(
                    colAllData,
                    BankName = drpBankName.SelectedText.Value And ThisRecord.Date < dteToDate.SelectedDate
                )
            );
            ExportToExcel.Run(
                JSON(colExportToExcel),
                If(
                    drpBankName.SelectedText.Value = "NABIL BANK LTD.",
                    "Nabil",
                    If(
                        drpBankName.SelectedText.Value = "NEPAL BANK LTD.",
                        "Nepal Bank",
                        If(
                            drpBankName.SelectedText.Value = "BANK OF KATHMANDU LTD.",
                            "BOK",
                            If(
                                drpBankName.SelectedText.Value = "GLOBAL IME BANK LTD.",
                                "Global",
                                If(
                                    drpBankName.SelectedText.Value = "JYOTI BIKASH BANK LTD.",
                                    "JBBL",
                                    If(
                                        drpBankName.SelectedText.Value = "KUMARI BANK LTD.",
                                        "Kumari",
                                        If(
                                            drpBankName.SelectedText.Value = "LAXMI SUNRISE BANK LTD.",
                                            "Laxmi Sunrise",
                                            If(
                                                drpBankName.SelectedText.Value = "LUMBINI BIKAS BANK LTD.",
                                                "LBBL",
                                                If(
                                                    drpBankName.SelectedText.Value = "MEGA BANK NEPAL LTD.",
                                                    "Mega",
                                                    If(
                                                        drpBankName.SelectedText.Value = "NEPAL INVESTMENT BANK LTD.",
                                                        "NIBL",
                                                        If(
                                                            drpBankName.SelectedText.Value = "NEPAL SBI BANK LTD.",
                                                            "SBI",
                                                            If(
                                                                drpBankName.SelectedText.Value = "PRABHU BANK LTD.",
                                                                "Prabhu",
                                                                If(
                                                                    drpBankName.SelectedText.Value = "SIDDHARTHA BANK LTD.",
                                                                    "Siddhartha",
                                                                    If(
                                                                        drpBankName.SelectedText.Value = "MACHHAPUCHCHHRE BANK LTD.",
                                                                        "MBL",
                                                                        If(
                                                                            drpBankName.SelectedText.Value = "CITIZENS BANK INTERNATIONAL LTD.",
                                                                            "Citizen"
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                ),
                If(
                    drpBankName.SelectedText.Value = "NABIL BANK LTD.",
                    "bhagbat.kc@imark.com.np",
                    If(
                        drpBankName.SelectedText.Value = "NEPAL BANK LTD.",
                        "sagar.khattri@imark.com.np",
                        If(
                            drpBankName.SelectedText.Value = "BANK OF KATHMANDU LTD.",
                            "BOK",
                            If(
                                drpBankName.SelectedText.Value = "GLOBAL IME BANK LTD.",
                                "Global",
                                If(
                                    drpBankName.SelectedText.Value = "JYOTI BIKASH BANK LTD.",
                                    "JBBL",
                                    If(
                                        drpBankName.SelectedText.Value = "KUMARI BANK LTD.",
                                        "Kumari",
                                        If(
                                            drpBankName.SelectedText.Value = "LAXMI SUNRISE BANK LTD.",
                                            "Laxmi Sunrise",
                                            If(
                                                drpBankName.SelectedText.Value = "LUMBINI BIKAS BANK LTD.",
                                                "LBBL",
                                                If(
                                                    drpBankName.SelectedText.Value = "MEGA BANK NEPAL LTD.",
                                                    "Mega",
                                                    If(
                                                        drpBankName.SelectedText.Value = "NEPAL INVESTMENT BANK LTD.",
                                                        "NIBL",
                                                        If(
                                                            drpBankName.SelectedText.Value = "NEPAL SBI BANK LTD.",
                                                            "SBI",
                                                            If(
                                                                drpBankName.SelectedText.Value = "PRABHU BANK LTD.",
                                                                "Prabhu",
                                                                If(
                                                                    drpBankName.SelectedText.Value = "SIDDHARTHA BANK LTD.",
                                                                    "Siddhartha",
                                                                    If(
                                                                        drpBankName.SelectedText.Value = "MACHHAPUCHCHHRE BANK LTD.",
                                                                        "MBL",
                                                                        If(
                                                                            drpBankName.SelectedText.Value = "CITIZENS BANK INTERNATIONAL LTD.",
                                                                            "Citizen"
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
            Notify(
                "Exported to excel successfully!!!",
                NotificationType.Success
            );
        Text: ="Export to Excel"
        X: =347
        Y: =692
        ZIndex: =10

    lblSelectDate As label:
        Text: |-
            ="Select Bank
            "
        X: =7
        Y: =563
        ZIndex: =11

    Label3 As label:
        Align: =Align.Center
        Text: =CountRows(colInvoice)
        X: =1086
        Y: =646
        ZIndex: =12

    txtNumberOfDays As text:
        Default: =""
        HintText: ="No Of Days"
        Visible: =locTogText
        X: =867
        Y: =603
        ZIndex: =13

    lblNoOfDays As label:
        Text: ="No of Days"
        Visible: =locTogText
        X: =868
        Y: =563
        ZIndex: =14

    "'Generate Invoice' As button":
        DisplayMode: =If(glbToggleButton,DisplayMode.Edit,DisplayMode.Disabled)
        OnSelect: =Navigate(Invoice,ScreenTransition.Fade);
        Text: ="Generate Invoice"
        Width: =193
        X: =556
        Y: =692
        ZIndex: =15

    Label4 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Height: =45
        Text: |-
            =If(
                drpBankName.SelectedText.Value = "NABIL BANK LTD.",
                "Nabil",
                If(
                    drpBankName.SelectedText.Value = "NEPAL BANK LTD.",
                    "Nepal Bank",
                    If(
                        drpBankName.SelectedText.Value = "BANK OF KATHMANDU LTD.",
                        "BOK",
                        If(
                            drpBankName.SelectedText.Value = "GLOBAL IME BANK LTD.",
                            "Global",
                            If(
                                drpBankName.SelectedText.Value = "JYOTI BIKASH BANK LTD.",
                                "JBBL",
                                If(
                                    drpBankName.SelectedText.Value = "KUMARI BANK LTD.",
                                    "Kumari",
                                    If(
                                        drpBankName.SelectedText.Value = "LAXMI SUNRISE BANK LTD.",
                                        "Laxmi Sunrise",
                                        If(
                                            drpBankName.SelectedText.Value = "LUMBINI BIKAS BANK LTD.",
                                            "LBBL",
                                            If(
                                                drpBankName.SelectedText.Value = "MEGA BANK NEPAL LTD.",
                                                "Mega",
                                                If(
                                                    drpBankName.SelectedText.Value = "NEPAL INVESTMENT BANK LTD.",
                                                    "NIBL",
                                                    If(
                                                        drpBankName.SelectedText.Value = "NEPAL SBI BANK LTD.",
                                                        "SBI",
                                                        If(
                                                            drpBankName.SelectedText.Value = "PRABHU BANK LTD.",
                                                            "Prabhu",
                                                            If(
                                                                drpBankName.SelectedText.Value = "SIDDHARTHA BANK LTD.",
                                                                "Siddhartha",
                                                                If(
                                                                    drpBankName.SelectedText.Value = "MACHHAPUCHCHHRE BANK LTD.",
                                                                    "MBL",
                                                                     If(
                                                                    drpBankName.SelectedText.Value = "CITIZENS BANK INTERNATIONAL LTD.",
                                                                    "Citizen")
            
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        Width: =72
        X: =1007
        Y: =644
        ZIndex: =16

